#Generated Time: $Timestamp
# pull down the build container
FROM microsoft/dotnet:$IMAGETYPE-aspnetcore-runtime-alpine3.8
ENV USERNAME=$USERNAME
ENV GROUP=$GROUP
ENV HOME=/home/${USERNAME}
RUN mkdir -p ${HOME}
# Create a group and user (system account) which will execute the app
# Alpine uses addgroup and adduser and not groupadd and useradd
 RUN addgroup -S -g 3000 ${GROUP} && adduser -S -u 1000 ${USERNAME} -G ${GROUP} -h ${HOME} -s /sbin/nologin
# Change the context to the app user
USER ${USERNAME}
ENV COMPlus_EnableDiagnostics=0

# copy build output
COPY . /app
WORKDIR /app

# expose ports
#EXPOSE 443
#EXPOSE 80
EXPOSE 5001

# start the service
ENTRYPOINT ["dotnet", "$DLLNAME", "RunContainer"]
